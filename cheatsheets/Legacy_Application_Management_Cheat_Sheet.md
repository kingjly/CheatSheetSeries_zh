# 遗留应用程序管理备忘录

## 引言

遗留应用程序是指被认为已过时但仍在组织中actively使用的应用程序。这可能发生在以下情况：
- 没有可行的应用程序替代方案
- 替换成本目前过高
- 应用程序高度定制，在组织的数字生态系统中服务于非常特定的角色

遗留应用程序常常会为组织引入重大安全风险，原因如下：

- 遗留应用程序可能已达到生命周期终止（EoL），意味着应用程序不再接收补丁或供应商支持。这极大地增加了应用程序漏洞保持可利用状态的风险。
- 某些应用程序是使用不再常规使用或不再教授给技术人员的技术构建的。这意味着在出现漏洞时，可能缺乏所需的故障排除或修复知识。
- 遗留应用程序可能以自定义格式生成数据，和/或使用旧接口或网络协议。这可能阻碍使用应用程序生成的数据与用于漏洞管理或安全日志记录的服务（如 SIEM）的工作。

由于没有一种适用于所有情况的方法来保护遗留应用程序，本备忘录旨在作为资源，提供一些在不存在遗留应用程序替代方案时加固遗留应用程序的实用建议。首选方法将取决于多个因素，如：
- 遗留应用程序存储和生成的数据类型
- 应用程序及其关联基础设施是否存在已知漏洞
- 限制遗留应用程序或其某些高风险组件访问的可能程度

可能需要与安全领域专家（内部或外部）合作，以提供具体和情境化的建议。

## 清单和资产管理

作为基准，组织应清楚地了解当前正在使用哪些遗留应用程序，以及使用这些遗留解决方案的预期风险。

**清单管理：** 首先编制文档，识别组织使用的遗留应用程序，包括：
- 版本号
- 生产日期
- 相关配置设置
- 需要位于哪些网络主机上才能访问应用程序和相关基础设施
- 托管应用程序和/或数据存储的基础设施上运行的服务记录

在某些情况下，文档可能包括：
- 与应用程序相关的服务器的物理位置
- 服务器的允许访问权限

组织可以选择在此过程中生成正式的软件材料清单（SBOM）。当应用程序依赖第三方依赖项才能运行时，SBOM 会发挥有用的作用。

**风险评估和威胁建模：** 确保组织清楚地了解：
- 使用遗留应用程序的风险水平
- 遗留应用程序及其特定组件（如特定 API 路由或托管基础设施上的开放端口）可能带来的威胁类型

这可以通过以下方式实现：
- 正式或非正式的应用程序威胁建模（参见[威胁建模备忘录](Threat_Modeling_Cheat_Sheet.md)）
- 使用行业标准风险评估框架，如 NIST（国家标准与技术研究院）[风险管理框架](https://csrc.nist.gov/Projects/risk-management)

作为衡量保护应用程序的安全措施应有多么保守的非正式指标，请考虑以下问题：

1. 应用程序处理/存储什么信息？如果这些信息被泄露，将如何影响您的业务和潜在的监管/合规要求？
2. 应用程序/应用程序依赖项/支持应用程序的基础设施是否存在已知漏洞？如果是，这些漏洞有多容易被利用？是否可以通过适当的资源（包括熟练的专业人员）进行修补？
3. 遗留应用程序对您组织的业务连续性有多关键？
4. 如果攻击者能够访问此应用程序，是否有风险他们可以用它从您的组织中窃取其他关键信息？通过破坏遗留应用程序，攻击者是否可以建立对特权网络或环境的访问？

## 身份验证/授权

授权措施强制执行关于谁可以访问给定资源以及如何建立对该资源的访问的规则。[授权备忘录](Authorization_Cheat_Sheet.md)对授权进行了深入讨论。

处理遗留系统的授权控制时，组织应将应用程序视为固有的高风险。最小特权安全原则（仅允许员工/用户/系统执行其所需角色和促进业务运营所严格需要的访问）特别适用于遗留应用程序。考虑实施以下内容（如适用）：

- 对应用程序应用网络级访问控制
- 在更细粒度级别考虑授权控制
- 确保只有经过身份验证的用户可以访问应用程序
- 关闭主机上不严格需要的端口
- 在某些情况下，可以通过开发中间服务来限制几乎所有用户直接访问遗留应用程序

## 漏洞管理

**漏洞扫描：** 遗留应用程序应接受：
- 使用行业标准漏洞评估工具的定期漏洞扫描
- 代码扫描工具（如 SAST 和 SCA）
- 在某些情况下，可能需要直接人工评估

**补丁管理：** 在可能的情况下：
- 应用由工具提出的补丁
- 根据漏洞严重性和是否有已发布的 CVE 或公开列出的漏洞来确定补丁工作的优先级
- 在无法实际修补的情况下，考虑对应用程序/受影响组件应用额外限制

## 数据存储

确认尽可能对应用程序处理的数据进行：
- 静态加密（存储在数据库中时）
- 传输中加密

## 确保可维护性

目标是：
- 维护关于应用程序的高度机构专业知识
- 确保多名员工能够排除故障/重新配置遗留应用程序
- 鼓励员工定期记录流程
- 必要时教授员工使用遗留应用程序语言编写基本程序

## 变更管理

最终目标是迁移到可维护且能够抵御当代威胁的解决方案。变更管理应考虑：
- 可分配的预算
- 所需专业知识
- 迁移的紧迫程度

## 持续监控和事件响应

遗留应用程序应：
- 接受高度安全监控
- 快速响应潜在事件
- 开发自定义 API 或自动化脚本以处理日志
- 警惕异常网络流量
- 确保事件响应团队优先处理关键遗留系统
- 制定业务连续性计划
